

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Installing PX4 &mdash; HippoCampusDocs  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/tabs.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/tabs.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Starting Simulation" href="starting_gazebo_simulation.html" />
    <link rel="prev" title="Setting Up Catkin Workspace" href="setting_up_catkin_workspace.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> HippoCampusDocs
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../getting_started.html">Getting Started</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="installing_ros.html">Installing ROS</a></li>
<li class="toctree-l2"><a class="reference internal" href="setting_up_catkin_workspace.html">Setting Up Catkin Workspace</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Installing PX4</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#get-the-code">Get The Code</a></li>
<li class="toctree-l3"><a class="reference internal" href="#export-environment-variables">Export Environment Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sensible-modifications">Sensible Modifications</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#battery-invalid">Battery Invalid</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="starting_gazebo_simulation.html">Starting Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="deploying_hippocampus.html">Deploying HippoCampus</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../raspberry_pi_4b_setup.html">Raspberry Pi 4B Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bluerov.html">BlueROV</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gantry.html">Gantry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../workflow_and_style_guide.html">Workflow and Style Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../src.html">Documentation of the Source Code</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">HippoCampusDocs</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
           

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../getting_started.html">Getting Started</a> &raquo;</li>
        
      <li>Installing PX4</li>
    
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            
              <a href="https://github.com/HippoCampusRobotics/docs/blob/master/getting_started/installing_px4.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
    <li class="wy-breadcrumbs-aside"><a href="https://hippocampusrobotics.github.io/" class="fa fa-github"> Project Page </a></li>

  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="installing-px4">
<h1>Installing PX4<a class="headerlink" href="#installing-px4" title="Permalink to this headline">¶</a></h1>
<p>We try to stick to the original PX4 software as much as possible.</p>
<p>Feel free to modifiy your fork of the autopilot as much as you want, but if you add functionality, that should be shared with the rest of the world, create a pull request.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following instructions assume, you want to clone the PX4-Autopilot in your home directory. If you don’t, you have to modifiy the instructions accordingly.</p>
</div>
<div class="section" id="get-the-code">
<h2>Get The Code<a class="headerlink" href="#get-the-code" title="Permalink to this headline">¶</a></h2>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git clone --recursive https://github.com/PX4/PX4-Autopilot.git
</pre></div>
</div>
</div>
<div class="section" id="export-environment-variables">
<h2>Export Environment Variables<a class="headerlink" href="#export-environment-variables" title="Permalink to this headline">¶</a></h2>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nv">PX4_DIR</span><span class="o">=</span><span class="nv">$HOME</span>/PX4-Autopilot
</pre></div>
</div>
<p>Choose the option depending on your shell:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-0-enNo" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-enNo" name="enNo" role="tab" tabindex="0">zsh</button><button aria-controls="panel-0-YmFzaA==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-YmFzaA==" name="YmFzaA==" role="tab" tabindex="-1">bash</button></div><div aria-labelledby="tab-0-enNo" class="sphinx-tabs-panel code-tab group-tab" id="panel-0-enNo" name="enNo" role="tabpanel" tabindex="0"><div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">echo</span> <span class="s2">&quot;source </span><span class="nv">$PX4_DIR</span><span class="s2">/Tools/setup_gazebo.bash </span><span class="nv">$PX4_DIR</span><span class="s2"> </span><span class="nv">$PX4_DIR</span><span class="s2">/build/px4_sitl_default &gt; /dev/null&quot;</span> &gt;&gt; ~/.zshrc
<span class="nb">echo</span> <span class="s2">&quot;export ROS_PACKAGE_PATH=\$ROS_PACKAGE_PATH:</span><span class="nv">$PX4_DIR</span><span class="s2">&quot;</span> &gt;&gt; ~/.zshrc
<span class="nb">echo</span> <span class="s2">&quot;export ROS_PACKAGE_PATH=\$ROS_PACKAGE_PATH:</span><span class="nv">$PX4_DIR</span><span class="s2">/Tools/sitl_gazebo&quot;</span> &gt;&gt; ~/.zshrc
</pre></div>
</div>
</div><div aria-labelledby="tab-0-YmFzaA==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-0-YmFzaA==" name="YmFzaA==" role="tabpanel" tabindex="0"><div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">echo</span> <span class="s2">&quot;source </span><span class="nv">$PX4_DIR</span><span class="s2">/Tools/setup_gazebo.bash </span><span class="nv">$PX4_DIR</span><span class="s2"> </span><span class="nv">$PX4_DIR</span><span class="s2">/build/px4_sitl_default &gt; /dev/null&quot;</span> &gt;&gt; ~/.bashrc
<span class="nb">echo</span> <span class="s2">&quot;export ROS_PACKAGE_PATH=\$ROS_PACKAGE_PATH:</span><span class="nv">$PX4_DIR</span><span class="s2">&quot;</span> &gt;&gt; ~/.bashrc
<span class="nb">echo</span> <span class="s2">&quot;export ROS_PACKAGE_PATH=\$ROS_PACKAGE_PATH:</span><span class="nv">$PX4_DIR</span><span class="s2">/Tools/sitl_gazebo&quot;</span> &gt;&gt; ~/.bashrc
</pre></div>
</div>
</div></div>
</div>
<div class="section" id="sensible-modifications">
<h2>Sensible Modifications<a class="headerlink" href="#sensible-modifications" title="Permalink to this headline">¶</a></h2>
<div class="section" id="battery-invalid">
<h3>Battery Invalid<a class="headerlink" href="#battery-invalid" title="Permalink to this headline">¶</a></h3>
<p>If the battery parameters are set up correctly and your battery values are not shown in QGroundControl, this might be because the firmware detects the battery errenously as invalid. This happens for example on the BlueROV, where the FCU is powered via USB and the power sense module provides only the measurements but not the supply voltage.</p>
<p>In <code class="code docutils literal notranslate"><span class="pre">analog_battery.cpp:l:83</span></code> the following expression evaluates as <code class="code docutils literal notranslate"><span class="pre">false</span></code>.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">bool</span> <span class="n">connected</span> <span class="o">=</span> <span class="n">voltage_v</span> <span class="o">&gt;</span> <span class="n">BOARD_ADC_OPEN_CIRCUIT_V</span> <span class="o">&amp;&amp;</span>
                     <span class="p">(</span><span class="n">BOARD_ADC_OPEN_CIRCUIT_V</span> <span class="o">&lt;=</span> <span class="n">BOARD_VALID_UV</span> <span class="o">||</span> <span class="n">is_valid</span><span class="p">());</span>
</pre></div>
</div>
<p>As a quickfix, replace <code class="code docutils literal notranslate"><span class="pre">is_valid()</span></code> with <code class="code docutils literal notranslate"><span class="pre">true</span></code>.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="starting_gazebo_simulation.html" class="btn btn-neutral float-right" title="Starting Simulation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="setting_up_catkin_workspace.html" class="btn btn-neutral float-left" title="Setting Up Catkin Workspace" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, Thies Lennart Alff.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>