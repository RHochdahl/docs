

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Raspberry Pi 4B Setup &mdash; HippoCampusDocs  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/sphinx_tabs/semantic-ui-2.4.1/segment.min.css" type="text/css" />
  <link rel="stylesheet" href="../_static/sphinx_tabs/semantic-ui-2.4.1/menu.min.css" type="text/css" />
  <link rel="stylesheet" href="../_static/sphinx_tabs/semantic-ui-2.4.1/tab.min.css" type="text/css" />
  <link rel="stylesheet" href="../_static/sphinx_tabs/tabs.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/sphinx_tabs/semantic-ui-2.4.1/tab.min.js"></script>
        <script src="../_static/sphinx_tabs/tabs.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Deploying HippoCampus" href="deploying_hippocampus.html" />
    <link rel="prev" title="Starting Simulation" href="starting_gazebo_simulation.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> HippoCampusDocs
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../getting_started.html">Getting Started</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="installing_ros.html">Installing ROS</a></li>
<li class="toctree-l2"><a class="reference internal" href="setting_up_catkin_workspace.html">Setting Up Catkin Workspace</a></li>
<li class="toctree-l2"><a class="reference internal" href="installing_px4.html">Installing PX4</a></li>
<li class="toctree-l2"><a class="reference internal" href="starting_gazebo_simulation.html">Starting Simulation</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Raspberry Pi 4B Setup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pre-boot-configuration">Pre-Boot Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#system-configuration">System Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ros-installation">ROS Installation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#preparations">Preparations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#setup-workspace">Setup Workspace</a></li>
<li class="toctree-l4"><a class="reference internal" href="#build-the-code">Build the Code</a></li>
<li class="toctree-l4"><a class="reference internal" href="#initialize-user-workspace">Initialize User Workspace</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ros-network">ROS Network</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#install-ros-packages">Install ROS Packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="#camera">Camera</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configure-uart">Configure UART</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ethernet-configuration">Ethernet Configuration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="deploying_hippocampus.html">Deploying HippoCampus</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../bluerov.html">BlueROV</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gantry.html">Gantry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../workflow_and_style_guide.html">Workflow and Style Guide</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">HippoCampusDocs</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
           















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../getting_started.html">Getting Started</a> &raquo;</li>
        
      <li>Raspberry Pi 4B Setup</li>
    
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/HippoCampusRobotics/docs/blob/master/getting_started/raspberrypi_4b_setup.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
    <li class="wy-breadcrumbs-aside"><a href="https://hippocampusrobotics.github.io/" class="fa fa-github"> Project Page </a></li>

  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="raspberry-pi-4b-setup">
<h1>Raspberry Pi 4B Setup<a class="headerlink" href="#raspberry-pi-4b-setup" title="Permalink to this headline">¶</a></h1>
<div class="section" id="pre-boot-configuration">
<h2>Pre-Boot Configuration<a class="headerlink" href="#pre-boot-configuration" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p>Flash an Raspbian Buster image to an SD card with the tool of your choice (for example <a class="reference external" href="https://www.raspberrypi.org/downloads/">Raspberry Pi Imager</a>).</p></li>
<li><p>Do not eject the SD card yet. Download the <a class="reference download external" download="" href="https://gist.github.com/lennartalff/5cf69169edcca7bc6bfc7909a567f67d"><code class="xref download docutils literal notranslate"><span class="pre">Boot</span> <span class="pre">partition</span> <span class="pre">files</span></code></a> and move them to the <code class="file docutils literal notranslate"><span class="pre">boot</span></code> partition of the SD card.</p>
<dl class="simple">
<dt>ssh</dt><dd><p>Empty file that enables the SSH server on the Raspberry Pi.</p>
</dd>
<dt>cmdline.txt</dt><dd><p>Removed <code class="code docutils literal notranslate"><span class="pre">plymouth.ignore-serial-consoles</span></code> to enable output during boot process if connected via serial console.</p>
</dd>
<dt>config.txt</dt><dd><p>Added some lines to enable the serial console, camera, etc.</p>
</dd>
<dt>wpa_supplicant.conf</dt><dd><p>Configuration file for setting up Wifi. Modify or complement, if your Wifi setup requires it.</p>
</dd>
</dl>
</li>
</ol>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Please replace the password in the <code class="file docutils literal notranslate"><span class="pre">wpa_supplicant.conf</span></code> with the correct one!</p>
</div>
<p>Also change your hostname before the first boot, by editing <code class="file docutils literal notranslate"><span class="pre">etc/hosts</span></code> and <code class="file docutils literal notranslate"><span class="pre">etc/hostname</span></code> on the <code class="file docutils literal notranslate"><span class="pre">rootfs</span></code> partition of the SD card. Replace the default hostname <code class="file docutils literal notranslate"><span class="pre">raspberrypi</span></code> with the new hostname.</p>
<p>Naming scheme is <code class="file docutils literal notranslate"><span class="pre">hippo-main-nn</span></code> for the Raspberry Pi connected with the FCU and <code class="file docutils literal notranslate"><span class="pre">hippo-buddy-nn</span></code> if it is the secondary Raspberry Pi. Replace <code class="file docutils literal notranslate"><span class="pre">nn</span></code> by a two digit long number with leading zero.</p>
</div>
<div class="section" id="system-configuration">
<h2>System Configuration<a class="headerlink" href="#system-configuration" title="Permalink to this headline">¶</a></h2>
<p>Insert SD card into Raspberry Pi. If your network is configured appropriately you can SSH into the Raspberry Pi. Otherwise connect your computer with the TX/RX pins of the Raspberry Pi via an USB-serial-converter.</p>
<p>Login with default credentials, i.e. <code class="code docutils literal notranslate"><span class="pre">pi:raspberry</span></code>. Change the password by typing <code class="code docutils literal notranslate"><span class="pre">passwd</span></code>.</p>
<p>Perform a system update:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo apt update <span class="o">&amp;&amp;</span> sudo apt upgrade -y
</pre></div>
</div>
<p>Reboot the Pi.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo reboot
</pre></div>
</div>
</div>
<div class="section" id="ros-installation">
<h2>ROS Installation<a class="headerlink" href="#ros-installation" title="Permalink to this headline">¶</a></h2>
<p>In general you can follow the official instruction in the <a class="reference external" href="http://wiki.ros.org/ROSberryPi/Installing%20ROS%20Melodic%20on%20the%20Raspberry%20Pi">ROS wiki</a> to install ROS under Raspbian Buster on the Raspberry Pi. But the following instructions will use <code class="code docutils literal notranslate"><span class="pre">catkin</span></code> instead of <code class="code docutils literal notranslate"><span class="pre">catkin_make</span></code> or <code class="code docutils literal notranslate"><span class="pre">catkin_make_isolated</span></code>.</p>
<div class="section" id="preparations">
<h3>Preparations<a class="headerlink" href="#preparations" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p>Adding keys</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo sh -c <span class="s1">&#39;echo &quot;deb http://packages.ros.org/ros/ubuntu $(lsb_release -sc) main&quot; &gt; /etc/apt/sources.list.d/ros-latest.list&#39;</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo apt-key adv --keyserver hkp://ha.pool.sks-keyservers.net:80 --recv-key C1CF6E31E6BADE8868B172B4F42ED6FBAB17C654
</pre></div>
</div>
</li>
<li><p>Update source lists</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>sudo apt update
</pre></div>
</div>
</li>
<li><p>Install dependencies</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo apt install -y python-rosdep python-rosinstall-generator python-wstool python-rosinstall build-essential cmake python-catkin-tools
</pre></div>
</div>
</li>
<li><p>Initialize rosdep</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo rosdep init
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>rosdep update
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="setup-workspace">
<h3>Setup Workspace<a class="headerlink" href="#setup-workspace" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p>Create workspace</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir ~/ros_catkin_ws <span class="o">&amp;&amp;</span> <span class="nb">cd</span> ~/ros_catkin_ws
</pre></div>
</div>
</li>
<li><p>Fetch source code</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>The following commands will fetch the sources for the <code class="code docutils literal notranslate"><span class="pre">ros_comm</span></code> meta package and the <code class="code docutils literal notranslate"><span class="pre">perception</span></code> meta package. If you do not need all of them or if you need even more packages feel free to modify the following commands accordingly. Building unnecessary packages might be a waste of time.</p>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>rosinstall_generator ros_comm perception --rosdistro melodic --deps --wet-only --tar &gt; melodic-ros_comm-perception-wet.rosinstall
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>wstool init src melodic-ros_comm-perception-wet.rosinstall
</pre></div>
</div>
</li>
<li><p>Resolve dependencies</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>rosdep install -y --from-paths src --ignore-src --rosdistro melodic -r --os<span class="o">=</span>debian:buster
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="build-the-code">
<h3>Build the Code<a class="headerlink" href="#build-the-code" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p>Set the install space</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>catkin config --install-space /opt/ros/melodic
</pre></div>
</div>
</li>
<li><p>Use the <code class="code docutils literal notranslate"><span class="pre">install</span></code> configuration instead of <code class="code docutils literal notranslate"><span class="pre">devel</span></code></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>catkin config --install
</pre></div>
</div>
</li>
<li><p>Start the build process</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Depending on your package configuration the next command may take some time, i.e. a few hours if you want to build many packages.</p>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo catkin build --cmake-args -DCMAKE_BUILD_TYPE<span class="o">=</span>Release
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="initialize-user-workspace">
<h3>Initialize User Workspace<a class="headerlink" href="#initialize-user-workspace" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p>Source your ROS installation</p>
<div class="sphinx-tabs docutils container">
<div class="ui top attached tabular menu sphinx-menu docutils container">
<div class="active item sphinx-data-tab-enNo docutils container">
<div class="docutils container">
<p>zsh</p>
</div>
</div>
<div class="item sphinx-data-tab-YmFzaA== docutils container">
<div class="docutils container">
<p>bash</p>
</div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment code-tab sphinx-data-tab-enNo active docutils container">
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">source</span> /opt/ros/melodic/setup.zsh
</pre></div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment code-tab sphinx-data-tab-YmFzaA== docutils container">
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">source</span> /opt/ros/melodic/setup.bash
</pre></div>
</div>
</div>
</div>
</li>
<li><p>Create workspace</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>mkdir -p ~/catkin_ws/src <span class="o">&amp;&amp;</span> <span class="nb">cd</span> ~/catkin_ws
</pre></div>
</div>
</li>
<li><p>Initialize workspace</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>catkin init
</pre></div>
</div>
</li>
<li><p>Build empty workspace</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>catkin build
</pre></div>
</div>
</li>
</ol>
<p>This command created the devel directory inside your catkin workspace. To source your workspace you can either source it manually for each terminal session by executing <code class="code docutils literal notranslate"><span class="pre">source</span> <span class="pre">~/catkin_ws/devel/setup.bash</span></code>. A better way to handle this automatically is to append this command to your <code class="file docutils literal notranslate"><span class="pre">.bashrc</span></code> file.</p>
<div class="sphinx-tabs docutils container">
<div class="ui top attached tabular menu sphinx-menu docutils container">
<div class="active item sphinx-data-tab-enNo docutils container">
<div class="docutils container">
<p>zsh</p>
</div>
</div>
<div class="item sphinx-data-tab-YmFzaA== docutils container">
<div class="docutils container">
<p>bash</p>
</div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment code-tab sphinx-data-tab-enNo active docutils container">
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">echo</span> <span class="s1">&#39;source $HOME/catkin_ws/devel/setup.zsh&#39;</span> &gt;&gt; ~/.zshrc
</pre></div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment code-tab sphinx-data-tab-YmFzaA== docutils container">
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">echo</span> <span class="s1">&#39;source $HOME/catkin_ws/devel/setup.bash&#39;</span> &gt;&gt; ~/.bashrc
</pre></div>
</div>
</div>
</div>
<p>For this change of the <code class="file docutils literal notranslate"><span class="pre">.bashrc</span></code> to take effect immediately execute:</p>
<div class="sphinx-tabs docutils container">
<div class="ui top attached tabular menu sphinx-menu docutils container">
<div class="active item sphinx-data-tab-enNo docutils container">
<div class="docutils container">
<p>zsh</p>
</div>
</div>
<div class="item sphinx-data-tab-YmFzaA== docutils container">
<div class="docutils container">
<p>bash</p>
</div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment code-tab sphinx-data-tab-enNo active docutils container">
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">source</span> ~/.zshrc
</pre></div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment code-tab sphinx-data-tab-YmFzaA== docutils container">
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">source</span> ~/.bashrc
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="ros-network">
<h3>ROS Network<a class="headerlink" href="#ros-network" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><div class="sphinx-tabs docutils container">
<div class="ui top attached tabular menu sphinx-menu docutils container">
<div class="active item sphinx-data-tab-3-0 docutils container">
<div class="docutils container">
<p>hippo-main</p>
</div>
</div>
<div class="item sphinx-data-tab-3-1 docutils container">
<div class="docutils container">
<p>hippo-buddy</p>
</div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment sphinx-data-tab-3-0 active docutils container">
<div class="sphinx-tabs docutils container">
<div class="ui top attached tabular menu sphinx-menu docutils container">
<div class="active item sphinx-data-tab-enNo docutils container">
<div class="docutils container">
<p>zsh</p>
</div>
</div>
<div class="item sphinx-data-tab-YmFzaA== docutils container">
<div class="docutils container">
<p>bash</p>
</div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment code-tab sphinx-data-tab-enNo active docutils container">
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">echo</span> <span class="s1">&#39;export ROS_MASTER_URI=&quot;http://$(hostname --short).local:11311&quot;&#39;</span> &gt;&gt; ~/.zshrc
<span class="nb">echo</span> <span class="s1">&#39;export ROS_HOSTNAME=&quot;$(hostname --short).local&quot;&#39;</span> &gt;&gt; ~/.zshrc
</pre></div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment code-tab sphinx-data-tab-YmFzaA== docutils container">
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">echo</span> <span class="s1">&#39;export ROS_MASTER_URI=&quot;http://$(hostname --short).local:11311&quot;&#39;</span> &gt;&gt; ~/.bashrc
<span class="nb">echo</span> <span class="s1">&#39;export ROS_HOSTNAME=&quot;$(hostname --short).local&quot;&#39;</span> &gt;&gt; ~/.bashrc
</pre></div>
</div>
</div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment sphinx-data-tab-3-1 docutils container">
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Replace the number for hippo-main with the actual one.</p>
</div>
<div class="sphinx-tabs docutils container">
<div class="ui top attached tabular menu sphinx-menu docutils container">
<div class="active item sphinx-data-tab-enNo docutils container">
<div class="docutils container">
<p>zsh</p>
</div>
</div>
<div class="item sphinx-data-tab-YmFzaA== docutils container">
<div class="docutils container">
<p>bash</p>
</div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment code-tab sphinx-data-tab-enNo active docutils container">
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nv">HIPPO_MAIN</span><span class="o">=</span><span class="s2">&quot;hippo-main-01&quot;</span>
<span class="nb">echo</span> <span class="s2">&quot;export ROS_MASTER_URI=\&quot;http://</span><span class="nv">$HIPPO_MAIN</span><span class="s2">.local:11311\&quot;&quot;</span> &gt;&gt; ~/.zshrc
<span class="nb">echo</span> <span class="s1">&#39;export ROS_HOSTNAME=&quot;$(hostname --short).local&quot;&#39;</span> &gt;&gt; ~/.zshrc
</pre></div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment code-tab sphinx-data-tab-YmFzaA== docutils container">
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nv">HIPPO_MAIN</span><span class="o">=</span><span class="s2">&quot;hippo-main-01&quot;</span>
<span class="nb">echo</span> <span class="s2">&quot;export ROS_MASTER_URI=\&quot;http://</span><span class="nv">$HIPPO_MAIN</span><span class="s2">.local:11311\&quot;&quot;</span> &gt;&gt; ~/.bashrc
<span class="nb">echo</span> <span class="s1">&#39;export ROS_HOSTNAME=&quot;$(hostname --short).local&quot;&#39;</span> &gt;&gt; ~/.bashrc
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div></blockquote>
</div>
</div>
<div class="section" id="install-ros-packages">
<h2>Install ROS Packages<a class="headerlink" href="#install-ros-packages" title="Permalink to this headline">¶</a></h2>
<p>If you want to install a new package, for example <code class="file docutils literal notranslate"><span class="pre">apriltag_ros</span></code> you can generate a new <code class="file docutils literal notranslate"><span class="pre">.rosinstall</span></code> file and merge it with your current workspace with <code class="code docutils literal notranslate"><span class="pre">wstool</span></code>.</p>
<ol class="arabic">
<li><p>Change directory</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> ~/ros_catkin_ws
</pre></div>
</div>
</li>
<li><p>New <code class="file docutils literal notranslate"><span class="pre">.rosinstall</span></code> file</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>rosinstall_generator apriltag apriltag_ros &gt; apriltag_ros.rosinstall
</pre></div>
</div>
</li>
<li><p>Merge</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>wstool merge -t src apriltag_ros.rosinstall
</pre></div>
</div>
</li>
<li><p>Update</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>wstool update -t src
</pre></div>
</div>
</li>
<li><p>Install dependencies</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>rosdep install -y --from-paths src --ignore-src -r
</pre></div>
</div>
</li>
<li><p>Build</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>sudo catkin build --cmake-args -DCMAKE_BUILD_TYPE<span class="o">=</span>Release
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="camera">
<h2>Camera<a class="headerlink" href="#camera" title="Permalink to this headline">¶</a></h2>
<p>If the Raspberry Pi uses an OV9281 camera, you will have to install the MIPI camera library by Arducam.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git clone https://github.com/ArduCAM/MIPI_Camera.git
</pre></div>
</div>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> ~/MIPI_Camera/RPI <span class="o">&amp;&amp;</span> make install
</pre></div>
</div>
</div>
<div class="section" id="configure-uart">
<h2>Configure UART<a class="headerlink" href="#configure-uart" title="Permalink to this headline">¶</a></h2>
<p>We have made the decision, to use UART5 for the telemetry communication with the FCU and UART4 is connected to the debug port of the FCU.</p>
<p>To keep things simple, you can create a UDEV rule to create more meaningful names than the default <code class="file docutils literal notranslate"><span class="pre">ttyAMAx</span></code> naming convention.</p>
<p>First of all identify your KERNELS value for UART4 and UART5 by the following command:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>udevadm info --name<span class="o">=</span>/dev/ttyAMA1 --attribute-walk
</pre></div>
</div>
<div class="highlight-sh notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="highlight"><pre><span></span>looking at device <span class="s1">&#39;/devices/platform/soc/fe201800.serial/tty/ttyAMA1&#39;</span>:
<span class="nv">KERNEL</span><span class="o">==</span><span class="s2">&quot;ttyAMA1&quot;</span>
<span class="nv">SUBSYSTEM</span><span class="o">==</span><span class="s2">&quot;tty&quot;</span>
<span class="nv">DRIVER</span><span class="o">==</span><span class="s2">&quot;&quot;</span>

looking at parent device <span class="s1">&#39;/devices/ platform/soc/fe201800.serial&#39;</span>:
<span class="nv">KERNELS</span><span class="o">==</span><span class="s2">&quot;fe201800.serial&quot;</span>
<span class="nv">SUBSYSTEMS</span><span class="o">==</span><span class="s2">&quot;amba&quot;</span>
<span class="nv">DRIVERS</span><span class="o">==</span><span class="s2">&quot;uart-pl011&quot;</span>
ATTRS<span class="o">{</span>driver_override<span class="o">}==</span><span class="s2">&quot;(null)&quot;</span>
ATTRS<span class="o">{</span>id<span class="o">}==</span><span class="s2">&quot;00241011&quot;</span>
ATTRS<span class="o">{</span>irq0<span class="o">}==</span><span class="s2">&quot;14&quot;</span>

looking at parent device <span class="s1">&#39;/devices/ platform/soc&#39;</span>:
<span class="nv">KERNELS</span><span class="o">==</span><span class="s2">&quot;soc&quot;</span>
<span class="nv">SUBSYSTEMS</span><span class="o">==</span><span class="s2">&quot;platform&quot;</span>
<span class="nv">DRIVERS</span><span class="o">==</span><span class="s2">&quot;&quot;</span>
ATTRS<span class="o">{</span>driver_override<span class="o">}==</span><span class="s2">&quot;(null)&quot;</span>

looking at parent device <span class="s1">&#39;/devices/ platform&#39;</span>:
<span class="nv">KERNELS</span><span class="o">==</span><span class="s2">&quot;platform&quot;</span>
<span class="nv">SUBSYSTEMS</span><span class="o">==</span><span class="s2">&quot;&quot;</span>
<span class="nv">DRIVERS</span><span class="o">==</span><span class="s2">&quot;&quot;</span>
</pre></div>
</td></tr></table></div>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>The <code class="file docutils literal notranslate"><span class="pre">ttyAMAx</span></code> number is not specific for the UART device and depends on how many UARTs are activated.</p>
</div>
<ul>
<li><dl>
<dt>Debug Port</dt><dd><p>UART4</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>Tx/Rx &lt;-&gt; GPIO8/GPIO9 <span class="o">(</span><span class="nv">KERNELS</span><span class="o">==</span><span class="s2">&quot;fe201800.serial&quot;</span><span class="o">)</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt>Telemetry</dt><dd><p>UART5</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>Tx/Rx &lt;-&gt; GPIO12/GPIO13 <span class="o">(</span><span class="nv">KERNELS</span><span class="o">==</span><span class="s2">&quot;fe201a00.serial&quot;</span><span class="o">)</span>
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
<p>The resulting UDEV rule in <code class="file docutils literal notranslate"><span class="pre">/etc/udev/rules.d/50-serial.rules</span></code> is:</p>
<div class="highlight-sh notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nv">KERNEL</span><span class="o">==</span><span class="s2">&quot;ttyAMA[0-9]*&quot;</span>, <span class="nv">GROUP</span><span class="o">=</span><span class="s2">&quot;dialout&quot;</span>, ENV<span class="o">{</span>MOTOR_SERIAL<span class="o">}=</span><span class="s2">&quot;fcu_serial&quot;</span>

ENV<span class="o">{</span>MOTOR_SERIAL<span class="o">}==</span><span class="s2">&quot;fcu_serial&quot;</span>,  <span class="nv">SUBSYSTEM</span><span class="o">==</span><span class="s2">&quot;tty&quot;</span>, <span class="nv">KERNELS</span><span class="o">==</span><span class="s2">&quot;fe201800.serial&quot;</span>, <span class="nv">SYMLINK</span><span class="o">+=</span><span class="s2">&quot;fcu_debug&quot;</span>
ENV<span class="o">{</span>MOTOR_SERIAL<span class="o">}==</span><span class="s2">&quot;fcu_serial&quot;</span>,  <span class="nv">SUBSYSTEM</span><span class="o">==</span><span class="s2">&quot;tty&quot;</span>, <span class="nv">KERNELS</span><span class="o">==</span><span class="s2">&quot;fe201a00.serial&quot;</span>, <span class="nv">SYMLINK</span><span class="o">+=</span><span class="s2">&quot;fcu_tele&quot;</span>
</pre></div>
</td></tr></table></div>
<p>You can apply these changes by</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>sudo udevadm control --reload-rules <span class="o">&amp;&amp;</span> sudo udevadm trigger
</pre></div>
</div>
<p>To check, that the rule is applied correctly, you can execute</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>ls /dev/fcu* -l
</pre></div>
</div>
<p>The output should show symbolic links for the serial devices:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>lrwxrwxrwx <span class="m">1</span> root root <span class="m">7</span> Dec <span class="m">11</span> <span class="m">14</span>:57 /dev/fcu_debug -&gt; ttyAMA1
lrwxrwxrwx <span class="m">1</span> root root <span class="m">7</span> Dec <span class="m">11</span> <span class="m">14</span>:57 /dev/fcu_tele -&gt; ttyAMA2
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="file docutils literal notranslate"><span class="pre">ttyAMA</span></code> numbers might differ.</p>
</div>
</div>
<div class="section" id="ethernet-configuration">
<h2>Ethernet Configuration<a class="headerlink" href="#ethernet-configuration" title="Permalink to this headline">¶</a></h2>
<p>The Raspberry Pis are connected with each other via Ethernet. To have a flexible solution, we define a fallback profile in <code class="file docutils literal notranslate"><span class="pre">/etc/dhcpcd.conf</span></code>. So in case you connect the Raspberry Pi directly to the Router, it uses DHCP. If no DHCP server is available, the Raspberry Pis use the static IP address defined in the fallback profile.</p>
<p>Either uncomment the existing lines or add them, so <code class="file docutils literal notranslate"><span class="pre">dhcpcd.conf</span></code> contains the following:</p>
<div class="sphinx-tabs docutils container">
<div class="ui top attached tabular menu sphinx-menu docutils container">
<div class="active item sphinx-data-tab-aGlwcG8tbWFpbg== docutils container">
<div class="docutils container">
<p>hippo-main</p>
</div>
</div>
<div class="item sphinx-data-tab-aGlwcG8tYnVkZHk= docutils container">
<div class="docutils container">
<p>hippo-buddy</p>
</div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment code-tab sphinx-data-tab-aGlwcG8tbWFpbg== active docutils container">
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># It is possible to fall back to a static IP if DHCP fails:</span>
<span class="c1"># define static profile</span>
profile static_eth0
static <span class="nv">ip_address</span><span class="o">=</span><span class="m">10</span>.0.0.1/24

<span class="c1"># fallback to static profile on eth0</span>
interface eth0
fallback static_eth0
</pre></div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment code-tab sphinx-data-tab-aGlwcG8tYnVkZHk= docutils container">
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># It is possible to fall back to a static IP if DHCP fails:</span>
<span class="c1"># define static profile</span>
profile static_eth0
static <span class="nv">ip_address</span><span class="o">=</span><span class="m">10</span>.0.0.2/24

<span class="c1"># fallback to static profile on eth0</span>
interface eth0
fallback static_eth0
</pre></div>
</div>
</div>
</div>
<p>You might want to restart the Raspberry Pis.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="deploying_hippocampus.html" class="btn btn-neutral float-right" title="Deploying HippoCampus" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="starting_gazebo_simulation.html" class="btn btn-neutral float-left" title="Starting Simulation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Thies Lennart Alff

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>